#!/bin/sh
# POSIX compliance tests for false utility

. "$(dirname "$0")/../common.sh"

FALSE_BIN="${BIN_DIR}/false"

printf "Testing: false\n"
printf "========================================\n"

# Test 1: Exit code is non-zero (typically 1)
$FALSE_BIN
exit_code=$?
if [ "$exit_code" -ne 0 ]; then
    print_result "false exits with non-zero code" "PASS"
else
    print_result "false exits with non-zero code" "FAIL" "Exit code was 0"
fi

# Test 2: Exit code is specifically 1 (common convention)
test_exit_code "$FALSE_BIN" 1 "false exits with code 1"

# Test 3: No output to stdout
output=$($FALSE_BIN)
if [ -z "$output" ]; then
    print_result "false produces no stdout" "PASS"
else
    print_result "false produces no stdout" "FAIL"
fi

# Test 4: No output to stderr
stderr=$($FALSE_BIN 2>&1 >/dev/null)
if [ -z "$stderr" ]; then
    print_result "false produces no stderr" "PASS"
else
    print_result "false produces no stderr" "FAIL"
fi

# Test 5: Ignores arguments
$FALSE_BIN arg1 arg2 arg3
if [ $? -ne 0 ]; then
    print_result "false ignores arguments" "PASS"
else
    print_result "false ignores arguments" "FAIL"
fi

# Test 6: Works in conditional
if $FALSE_BIN; then
    print_result "false fails in conditional" "FAIL"
else
    print_result "false fails in conditional" "PASS"
fi

print_summary "false"